<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Lista de Productos</title>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #2c5282;
            margin-bottom: 30px;
        }
        .pedido-container {
            display: flex;
            gap: 20px;
        }
        .productos-lista {
            flex: 2;
        }
        .resumen-pedido {
            flex: 1;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            height: fit-content;
        }
        .producto-item {
            border-bottom: 1px solid #eee;
            padding: 12px 0;
            display: flex;
            justify-content: space-between;
        }
        .producto-nombre {
            font-weight: bold;
            flex: 2;
        }
        .producto-precio {
            color: #2c5282;
            font-weight: bold;
            flex: 1;
            text-align: right;
        }
        .total-section {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
            font-weight: bold;
            font-size: 1.2em;
        }
        .btn-seleccionar {
            background-color: #2c5282;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .btn-seleccionar:hover {
            background-color: #1a365d;
        }
        .productos-seleccionados {
            margin-top: 20px;
        }
        .producto-seleccionado {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed #ddd;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Productos Disponibles</h1>

    <div class="pedido-container">
        <div class="productos-lista">
            <div th:each="producto : ${productos}" class="producto-item">
                <div class="producto-nombre" th:text="${producto.nombre}"></div>
                <div class="producto-precio" th:text="'S/. ' + ${#numbers.formatDecimal(producto.precio, 1, 2)}"></div>
                <button class="btn-seleccionar" th:onclick="'agregarAlPedido(' + ${producto.id} + ', \'' + ${producto.nombre} + '\', ' + ${producto.precio} + ')'">
                    Agregar
                </button>
            </div>
        </div>

        <div class="resumen-pedido">
            <h3>Resumen del Pedido</h3>
            <div id="productos-seleccionados" class="productos-seleccionados">
                <!-- Aquí se mostrarán los productos seleccionados -->
            </div>
            <div class="total-section">
                <span>Total:</span>
                <span id="total-pedido">S/. 0.00</span>
            </div>
        </div>
    </div>
</div>

<script>
    let pedido = [];
    let total = 0;

    function agregarAlPedido(id, nombre, precio) {
        // Agregar producto al pedido
        pedido.push({
            id: id,
            nombre: nombre,
            precio: precio
        });

        // Actualizar total
        total += parseFloat(precio);

        // Actualizar la interfaz
        actualizarResumenPedido();
    }

    function actualizarResumenPedido() {
        const contenedor = document.getElementById('productos-seleccionados');
        const totalElement = document.getElementById('total-pedido');

        // Limpiar contenedor
        contenedor.innerHTML = '';

        // Agregar cada producto seleccionado
        pedido.forEach(producto => {
            const div = document.createElement('div');
            div.className = 'producto-seleccionado';
            div.innerHTML = `
                <span>${producto.nombre}</span>
                <span>S/. ${producto.precio.toFixed(2)}</span>
            `;
            contenedor.appendChild(div);
        });

        // Actualizar total
        totalElement.textContent = `S/. ${total.toFixed(2)}`;
    }

    // Función original mantenida por compatibilidad
    function seleccionarProducto(id) {
        console.log('Función seleccionarProducto llamada para ID:', id);
        // Puedes implementar aquí lógica adicional si es necesario
    }
</script>
</body>
</html>